{"version":3,"sources":["component/upload.js","component/tips.js","view/home.js"],"names":["Image","styled","img","Result","div","H1","h1","Dragger","Upload","Component","observer","useStore","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","setWidth","w","height","setHeight","h","serverFile","attributes","url","widthStr","heightStr","props","beforeUpload","file","setFile","setFileName","name","currentUser","message","warning","size","error","upLoad","then","console","log","success","catch","finally","isUploading","tip","spinning","className","InboxOutlined","target","href","fileName","alt","src","ref","onChange","current","value","placeholder","fullStr","Tips","children","Home"],"mappings":"oNAOMA,EAAQC,IAAOC,IAAV,iDAGLC,EAASF,IAAOG,IAAV,+FAMNC,EAAKJ,IAAOK,GAAV,sEAKDC,EAAWC,IAAXD,QAiIQE,EA/HGC,aAAS,WAAM,MAEGC,cAAzBC,EAFsB,EAEtBA,WAAYC,EAFU,EAEVA,UACbC,EAAOC,mBACPC,EAAOD,mBACPE,EAAQC,aAAc,iBAAO,CAC/BC,MAAO,KACPC,SAF+B,SAEtBC,GACLJ,EAAME,MAAQE,GAElB,eACI,OAAOJ,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAE/CG,OAAQ,KACRC,UAT+B,SASrBC,GACNP,EAAMK,OAASE,GAEnB,gBACI,OAAOP,EAAMK,OAAN,aAAqBL,EAAMK,QAAW,IAEjD,cACI,OAAOV,EAAWa,WAAWC,WAAWC,IAAID,WAAWC,IAAhD,gBAAwEV,EAAMW,SAAWX,EAAMY,eAaxGC,EAAQ,CAEVC,aAAc,SAAAC,GAIV,OAFApB,EAAWqB,QAAQD,GACnBpB,EAAWsB,YAAYF,EAAKG,MACC,MAAzBtB,EAAUuB,aACVC,IAAQC,QAAQ,+CACT,GAQPN,EAAKO,MAAQ,QACbF,IAAQG,MAAM,6EACP,IAEX5B,EACK6B,SACAC,MAAK,SAACjB,GACHkB,QAAQC,IAAInB,GACZY,IAAQQ,QAAQ,4BAChBF,QAAQC,IAAI,+BAEfE,OAAM,SAACN,GACJG,QAAQC,IAAIJ,GACZH,IAAQG,MAAM,4BACbG,QAAQC,IAAI,+BAEhBG,SAAQ,WACLnC,EAAWoC,aAAc,EACzBL,QAAQC,IAAI,gCAEb,KAQf,OACI,qCACI,cAAC,IAAD,CAAMK,IAAI,qBAAMC,SAAUtC,EAAWoC,YAArC,SACI,eAACzC,EAAD,2BAAauB,GAAb,cACI,mBAAGqB,UAAU,uBAAb,SACI,cAACC,EAAA,EAAD,MAEJ,mBAAGD,UAAU,kBAAb,0EAGA,mBAAGA,UAAU,kBAAb,kKAMJvC,EAAWa,WAAa,eAACtB,EAAD,WAChB,cAACE,EAAD,uCACA,8BACI,+BACI,sEACA,6BAAI,mBAAGgD,OAAO,QACPC,KAAM1C,EAAWa,WAAWC,WAAWC,IAAID,WAAWC,IADzD,SAC+Df,EAAWa,WAAWC,WAAWC,IAAID,WAAWC,QAEnH,oDACA,6BAAKf,EAAW2C,WAChB,0DACA,6BACI,cAACvD,EAAD,CAAOwD,IAAI,2BAAOC,IAAK7C,EAAWa,WAAWC,WAAWC,IAAID,WAAWC,QAE3E,0DACA,+BACI,uBAAO+B,IAAK5C,EAAM6C,SArF1B,WACpB1C,EAAMG,SAASN,EAAK8C,QAAQC,QAoF6CC,YAAY,qDACzD,uBAAOJ,IAAK1C,EAAM2C,SAnFzB,WACrB1C,EAAMM,UAAUP,EAAK4C,QAAQC,QAkF6CC,YAAY,wDAE9D,6BACI,mBAAGT,OAAO,SAASC,KAAMrC,EAAM8C,QAA/B,SAAyC9C,EAAM8C,oBAM7D,WC1IhBC,EAAO/D,IAAOG,IAAV,mJAqBKK,EAZGC,aAAS,YAAiB,IAAfuD,EAAc,EAAdA,SACdpD,EAAaF,cAAbE,UACP,OACI,mCAEQA,EAAUuB,YAAc,KAAO,cAAC4B,EAAD,UAAOC,SCbpDC,EAAOxD,aAAS,WAClB,OACI,qCACI,cAAC,EAAD,4EACA,cAAC,EAAD,UAMGwD","file":"static/js/13.db7576c7.chunk.js","sourcesContent":["import React, {useRef} from \"react\";\nimport {useStore} from \"../store\";\nimport {observer, useLocalStore} from \"mobx-react\"\nimport {Upload, message, Spin, Switch, Alert} from 'antd';\nimport {InboxOutlined} from '@ant-design/icons';\nimport styled from 'styled-components';\n\nconst Image = styled.img`\n  max-width: 300px;\n`\nconst Result = styled.div`\n  margin-top: 30px;\n  border: 2px dashed #ccc;\n  padding: 20px;\n`\n\nconst H1 = styled.h1`\n  margin: 20px 0;\n  text-align: center;\n`\n\nconst {Dragger} = Upload;\n\nconst Component = observer(() => {\n    // console.log('1') \n    const {ImageStore, UserStore} = useStore()\n    const ref1 = useRef();\n    const ref2 = useRef();\n    const store = useLocalStore(() => ({\n        width: null,\n        setWidth(w) {\n            store.width = w;\n        },\n        get widthStr() {\n            return store.width ? `/w/${store.width}` : '';\n        },\n        height: null,\n        setHeight(h) {\n            store.height = h;\n        },\n        get heightStr() {\n            return store.height ? `/h/${store.height}` : '';\n        },\n        get fullStr() {\n            return ImageStore.serverFile.attributes.url.attributes.url + `?imageView2/0` + store.widthStr + store.heightStr;\n        }\n    }))\n\n    const bindWidthChange = () => {\n        store.setWidth(ref1.current.value)\n    }\n    const bindHeightChange = () => {\n        store.setHeight(ref2.current.value)\n    }\n\n\n    //  console.log('2')\n    const props = {\n        // showUploadList: false,\n        beforeUpload: file => {\n            // console.log('3') 这里出现了错误，原因是beforeUpload的L不用大写，当前页面出bug了就在当前一面一步一步的执行下去\n            ImageStore.setFile(file);\n            ImageStore.setFileName(file.name);\n            if (UserStore.currentUser == null) {\n                message.warning('请先登录再上传')\n                return false;\n            }\n            ;\n            // if(!(/(jpg$)|(svg+xml$)|(jpeg$)|(png$)|(bmp$)/ig.test(file.type))){\n            //     message.error('请上传svg、jpg、jpeg、bmp、png格式的图片')\n            //     return false;\n            // };\n\n            if (file.size >= 1024000) {\n                message.error('请上传大小不超过1024KB的图片')\n                return false;\n            }\n            ImageStore\n                .upLoad()\n                .then((serverFile) => {\n                    console.log(serverFile);\n                    message.success('上传成功');\n                    console.log('上传成功')\n                })\n                .catch((error) => {\n                    console.log(error);\n                    message.error('上传失败');\n                    ;console.log('上传失败')\n                })\n                .finally(() => {\n                    ImageStore.isUploading = false;\n                    console.log('上传完成')\n                })\n            return false;\n        }\n    }\n\n\n    // console.log('4')    \n\n\n    return (\n        <>\n            <Spin tip=\"上传中\" spinning={ImageStore.isUploading}>\n                <Dragger {...props}>\n                    <p className=\"ant-upload-drag-icon\">\n                        <InboxOutlined/>\n                    </p>\n                    <p className=\"ant-upload-text\">\n                        点击或者拖拽上传地图\n                    </p>\n                    <p className=\"ant-upload-hint\">\n                        仅支持jpg、jpeg、bmp、svg、png格式的图片，同时不超过1024KB大小\n                    </p>\n                </Dragger>\n            </Spin>\n            {\n                ImageStore.serverFile ? <Result>\n                        <H1>上传结果</H1>\n                        <div>\n                            <dl>\n                                <dt>地图线上地址</dt>\n                                <dd><a target='_self'\n                                       href={ImageStore.serverFile.attributes.url.attributes.url}>{ImageStore.serverFile.attributes.url.attributes.url}</a>\n                                </dd>\n                                <dt>文件名</dt>\n                                <dd>{ImageStore.fileName}</dd>\n                                <dt>地图预览</dt>\n                                <dd>\n                                    <Image alt='加载失败' src={ImageStore.serverFile.attributes.url.attributes.url}/>\n                                </dd>\n                                <dt>更多尺寸</dt>\n                                <dd>\n                                    <input ref={ref1} onChange={bindWidthChange} placeholder=\"最大宽度（可选）\"/>\n                                    <input ref={ref2} onChange={bindHeightChange} placeholder=\"最大高度（可选）\"/>\n                                </dd>\n                                <dd>\n                                    <a target=\"_blank\" href={store.fullStr}>{store.fullStr}</a>\n                                </dd>\n                            </dl>\n                        </div>\n                    </Result>\n\n                    : null\n            }\n\n        </>\n    );\n});\n\nexport default Component;","import React from \"react\";\nimport {observer} from \"mobx-react\";\nimport {useStore} from \"../store\";\nimport styled from \"styled-components\";\n\nconst Tips = styled.div `\n  background: orange;\n  color: #fff;\n  padding: 10px;\n  margin: 30px 0;\n  font-size: 14px;\n  border-radius: 5px;\n`\n\nconst Component = observer(({children}) => {\n        const {UserStore} = useStore();\n        return (\n            <>\n                {\n                    UserStore.currentUser ? null : <Tips>{children}</Tips>\n                }\n            </>\n        )\n    }\n)\n\nexport default Component","import React from 'react';\nimport {observer} from 'mobx-react';\n// import {useStore } from '../store';\nimport Uploader from '../component/upload';\nimport Tips from '../component/tips'\n\nconst Home = observer(() => {\n    return (\n        <>\n            <Tips>请先登录再上传 ！！！</Tips>\n            <Uploader/>\n        </>\n    )\n})\n\n\nexport default Home;\n"],"sourceRoot":""}